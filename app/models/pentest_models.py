"""
Penetration Test & Red Team Simulator
veri modelleri.
"""

from enum import Enum
from typing import Any

from pydantic import BaseModel, Field


class TestType(str, Enum):
    """Test tipleri."""

    NETWORK_SCAN = "network_scan"
    PORT_SCAN = "port_scan"
    WEB_APP = "web_app"
    API_TEST = "api_test"
    AUTH_TEST = "auth_test"
    INJECTION_TEST = "injection_test"
    CONFIG_AUDIT = "config_audit"
    SSL_CHECK = "ssl_check"


class SeverityLevel(str, Enum):
    """Ciddiyet seviyeleri."""

    INFO = "info"
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    CRITICAL = "critical"


class ExploitCategory(str, Enum):
    """Istismar kategorileri."""

    SQL_INJECTION = "sql_injection"
    XSS = "xss"
    CSRF = "csrf"
    RCE = "rce"
    PRIVILEGE_ESCALATION = (
        "privilege_escalation"
    )
    PATH_TRAVERSAL = "path_traversal"
    SSRF = "ssrf"
    DESERIALIZATION = "deserialization"
    BUFFER_OVERFLOW = "buffer_overflow"


class AttackType(str, Enum):
    """Saldiri tipleri."""

    PHISHING_EMAIL = "phishing_email"
    SPEAR_PHISHING = "spear_phishing"
    PRETEXTING = "pretexting"
    BAITING = "baiting"
    TAILGATING = "tailgating"
    VISHING = "vishing"
    SMISHING = "smishing"


class ExerciseType(str, Enum):
    """Tatbikat tipleri."""

    FULL_SIMULATION = "full_simulation"
    TABLETOP = "tabletop"
    PURPLE_TEAM = "purple_team"
    ASSUMED_BREACH = "assumed_breach"
    PHYSICAL = "physical"
    SOCIAL_ENGINEERING = (
        "social_engineering"
    )


class ExerciseStatus(str, Enum):
    """Tatbikat durumlari."""

    PLANNED = "planned"
    ACTIVE = "active"
    PAUSED = "paused"
    COMPLETED = "completed"
    CANCELLED = "cancelled"


class RemediationPriority(str, Enum):
    """Duzeltme oncelikleri."""

    P0_IMMEDIATE = "p0_immediate"
    P1_URGENT = "p1_urgent"
    P2_HIGH = "p2_high"
    P3_MEDIUM = "p3_medium"
    P4_LOW = "p4_low"


class SecurityGrade(str, Enum):
    """Guvenlik notlari."""

    A = "A"
    B = "B"
    C = "C"
    D = "D"
    F = "F"


class PenTestFinding(BaseModel):
    """Sizma testi bulgusu."""

    finding_id: str = ""
    test_type: str = ""
    detail: str = ""
    severity: str = "medium"
    target: str = ""


class ExploitSimulation(BaseModel):
    """Istismar simulasyonu."""

    simulation_id: str = ""
    exploit_name: str = ""
    category: str = ""
    target: str = ""
    success: bool = False
    impact: str = "none"
    impact_score: float = 0.0


class WeaknessRecord(BaseModel):
    """Zafiyet kaydi."""

    weakness_id: str = ""
    name: str = ""
    severity: str = "medium"
    cvss_score: float = 0.0
    exploitability: str = "theoretical"
    business_impact: str = "moderate"
    status: str = "open"


class RemediationPlan(BaseModel):
    """Duzeltme plani."""

    plan_id: str = ""
    weakness_id: str = ""
    name: str = ""
    priority: str = "p2_high"
    status: str = "pending"
    estimated_hours: float = 0.0
    tasks: list[str] = Field(
        default_factory=list
    )


class AttackSurface(BaseModel):
    """Saldiri yuzeyi."""

    asset_id: str = ""
    name: str = ""
    asset_type: str = "web_app"
    host: str = ""
    is_external: bool = True
    entry_points: int = 0
    exposure_score: float = 0.0


class RedTeamExercise(BaseModel):
    """Kirmizi takim tatbikati."""

    exercise_id: str = ""
    name: str = ""
    exercise_type: str = (
        "full_simulation"
    )
    status: str = "planned"
    teams: list[str] = Field(
        default_factory=list
    )
    objectives: list[str] = Field(
        default_factory=list
    )


class SecurityScore(BaseModel):
    """Guvenlik puani."""

    overall_score: float = 0.0
    overall_grade: str = "F"
    categories: dict[str, Any] = Field(
        default_factory=dict
    )


class PentestStatus(BaseModel):
    """Sizma testi durumu."""

    safe_mode: bool = True
    total_tests: int = 0
    total_findings: int = 0
    total_weaknesses: int = 0
    total_exercises: int = 0
    overall_score: float = 0.0
